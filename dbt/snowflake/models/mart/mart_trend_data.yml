version: 2
  
models:
  - name: mart_trend_data
    columns:
      - name: ticker
        data_tests:
          - not_null
      - name: trading_date
        data_tests:
          - not_null
      - name: signal_sma_5
        data_tests:
          - accepted_values:
              name: signal_sma_5_accepted_values
              arguments:
                values: "{{ var('valid_signals') }}"
      - name: signal_sma_10
        data_tests:
          - accepted_values:
              name: signal_sma_10_accepted_values
              arguments:
                values: "{{ var('valid_signals') }}"
      - name: signal_sma_20
        data_tests:
          - accepted_values:
              name: signal_sma_20_accepted_values
              arguments:
                values: "{{ var('valid_signals') }}"
      - name: signal
        data_tests:
          - accepted_values:
              name: signal_accepted_values
              arguments:
                values: "{{ var('valid_signals') }}"
      - name: trend_sma_5
        data_tests:
          - accepted_values:
              name: sma_5_accepted_values
              arguments:
                values: "{{ var('valid_trend') }}"
      - name: trend_sma_10
        data_tests:
          - accepted_values:
              name: sma_10_accepted_values
              arguments:
                values: "{{ var('valid_trend') }}"
      - name: trend_sma_20
        data_tests:
          - accepted_values:
              name: sma_20_accepted_values
              arguments:
                values: "{{ var('valid_trend') }}"
      - name: trend
        data_tests:
          - accepted_values:
              name: trend_accepted_values
              arguments:
                values: "{{ var('valid_trend') }}"
      - name: close
        data_tests:
          - not_null
